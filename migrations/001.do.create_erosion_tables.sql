CREATE TABLE users (
    id INTEGER PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    username TEXT NOT NULL,
    password TEXT NOT NULL,
    handle TEXT UNIQUE NOT NULL
);

CREATE TABLE tiles (
    id INTEGER PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    type TEXT NOT NULL,
    resistance INTEGER NOT NULL
);

CREATE TABLE maps (
    id INTEGER PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    river_start_row INTEGER NOT NULL,
    river_start_column INTEGER NOT NULL,
    river_end_row INTEGER NOT NULL,
    river_end_column INTEGER NOT NULL
);

CREATE TABLE scores (
    id INTEGER PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    user_id INTEGER REFERENCES users(id) ON DELETE SET NULL,
    map_id INTEGER REFERENCES maps(id) ON DELETE SET NULL,
    final_score INTEGER NOT NULL,
    score INTEGER NOT NULL,
    soil_bonus INTEGER NOT NULL,
    location_bonus REAL NOT NULL,
    date DATE NOT NULL DEFAULT CURRENT_DATE
);

CREATE TABLE map_layouts (
    id INTEGER PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    map_id INTEGER REFERENCES maps(id) ON DELETE SET NULL,
    tile_id INTEGER REFERENCES tiles(id) ON DELETE SET NULL,
    position INTEGER NOT NULL
);